<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datos de permisos Gremiales</title>
    <style>
body {
  font-family: 'Arial', sans-serif; /* Define la fuente del texto como Arial o, si no está disponible, una fuente sans-serif genérica */
  background: linear-gradient(135deg, #a8d5ba, #d4e8d1, #b0e6c7); /* Aplica un fondo con un degradado lineal en un ángulo de 135 grados, usando tres tonos de verde suave */
  display: flex; /* Utiliza el modelo de caja flexible para el contenedor del body */
  flex-direction: column; /* Ordena los elementos hijos en una columna, uno debajo del otro */
  align-items: center; /* Centra horizontalmente todos los elementos hijos dentro del body */
  justify-content: center; /* Centra verticalmente todos los elementos hijos dentro del body */
  height: 100vh; /* Establece la altura del body al 100% de la altura de la ventana del navegador */
  margin: 0; /* Elimina el margen por defecto del navegador alrededor del body */
  padding: 20px; /* Agrega un relleno de 20 píxeles dentro del body */
}

h1 {
  color: #6ab04c; /* Color del texto del título */
}

table {
  border-collapse: collapse; /* Colapsa los bordes de las celdas en una sola línea */
  width: 80%; /* Establece el ancho de la tabla al 80% del contenedor */
  margin-top: 20px; /* Añade un margen superior de 20 píxeles */
  border: 1px solid #ccc; /* Bordea la tabla con una línea sólida y color gris claro */
  background-color: #fff; /* Color de fondo de la tabla */
  border-radius: 8px; /* Redondea las esquinas de la tabla */
  overflow: hidden; /* Oculta el contenido que sobresale del borde redondeado */
  box-shadow: 0 0 190px rgba(10, 1, 1, 10); /* Añade una sombra grande y centrada detrás de la tabla */
}
th, td {
  padding: 12px; /* Añade un relleno de 12 píxeles dentro de las celdas */
  border: 1px solid #ddd; /* Bordea las celdas con una línea sólida y color gris claro */
}

th {
  background-color: #6ab04c; /* Color de fondo de los encabezados de las columnas */
  color: white; /* Color del texto en los encabezados de las columnas */
}

td {
  text-align: center; /* Centra el texto dentro de las celdas */
}

button {
  padding: 6px 12px; /* Añade un relleno de 6 píxeles en vertical y 12 píxeles en horizontal */
  border: none; /* Elimina el borde por defecto */
  border-radius: 4px; /* Redondea las esquinas del botón */
  background-color: #6ab04c; /* Color de fondo del botón */
  color: white; /* Color del texto del botón */
  cursor: pointer; /* Cambia el cursor al pasar sobre el botón */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Añade una sombra al botón */
  transition: background-color 0.3s ease, box-shadow 0.3s ease; /* Suaviza la transición de color de fondo y sombra */
}

button:hover {
  background-color: #4a9e35; /* Color de fondo del botón al pasar el cursor sobre él */
  box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15); /* Sombra más fuerte al pasar el cursor sobre el botón */
}

.printed {
  background-color: #888; /* Color de fondo del botón cuando está impreso */
  cursor: default; /* Cambia el cursor a por defecto */
}

@media print {
  body {
    width: 210mm; /* Ancho del cuerpo al imprimir */
    height: 297mm; /* Altura del cuerpo al imprimir */
    margin: 0; /* Elimina el margen por defecto */
    padding: 20mm; /* Añade un relleno de 20mm */
    box-sizing: border-box; /* Incluye el padding y el border en el tamaño total */
    font-size: 12pt; /* Establece el tamaño de la fuente a 12 puntos */
  }
  .letter-content {
    width: 100%; /* Ancho del contenido de la carta */
    margin: 0; /* Elimina el margen */
    padding: 0; /* Elimina el padding */
    border: none; /* Elimina el borde */
    box-shadow: none; /* Elimina la sombra */
    background-color: white; /* Establece el color de fondo a blanco */
  }
  .letter-content h2, .letter-content p {
    margin: 0 0 10px 0; /* Añade un margen inferior de 10px */
  }
}


    </style>
    <script>
        async function fetchData() {
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbyEdpVTFCxOY7grZKC2zcs0J4vg0NbswTmg6RFjc2vruXYYLGCReDQkZiA94ZZeZsw/exec');
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                const tableBody = document.getElementById('table-body');

                // Remove header row from data
                data.shift();

                data.forEach((row, index) => {
                    const tr = document.createElement('tr');

                    row.forEach(cell => {
                        const td = document.createElement('td');
                        td.textContent = cell;
                        tr.appendChild(td);
                    });

                    const printButton = document.createElement('button');
                    printButton.textContent = 'Imprimir';
                    printButton.onclick = () => printRow(index + 1, printButton);

                    const td = document.createElement('td');
                    td.appendChild(printButton);
                    tr.appendChild(td);

                    tableBody.appendChild(tr);
                });
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        function printRow(rowIndex, button) {
            const rows = document.querySelectorAll('#data-table tr');
            const selectedRow = rows[rowIndex];

            const nombreApellido = selectedRow.cells[0].textContent;
            const fechaPermiso = selectedRow.cells[1].textContent;
            const empresa = selectedRow.cells[2].textContent;
            const fechaGeneracion = new Date().toLocaleDateString();

            const printContent = `
            <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        @media print {
                            body {
                                width: 210mm;
                                height: 297mm;
                                margin: 0;
                                padding: 20mm;
                                box-sizing: border-box;
                                font-size: 12pt;
                                font-family: Arial, sans-serif;
                            }
                            .letter-content {
                                width: 100%;
                                margin: 0;
                                padding: 0;
                                border: none;
                                box-shadow: none;
                                background-color: white;
                            }
                            .letter-content h2, .letter-content p {
                                margin: 0 0 10px 0;
                            }
                        }
                    </style>
                </head>
                <body>
                    <div class="letter-content">
                       <div style="text-align: center; margin-top: 140px;">
                         <h5 style="display: inline;line-height: 4;">Ciudad Autónoma de Buenos Aires</h5>
                         <p style="display: inline;">${fechaGeneracion}</p>
                         </div>
                        <p style="margin-top: 40px;">
                            De: <span style="font-size: 1.2em; font-weight: bold;">Rama Remolques Mecanicos</span></p>
                        <p>Cro.:<span style="font-size: 1.2em; font-weight: bold;"> Avendaño Hector</span></p>
                        <p>A: <span style="font-size: 1.2em; font-weight: bold;"> ${empresa}</span></p>
                        <p>______________________________________________________________Ref:<span style="font-size: 1.2em; font-weight: bold;"> Permiso gremial</span></p>
                        <p>De mi mayor consideración:</p>
                        <p style="line-height: 2;">Tenemos el agrado de dirigirnos a UD. Con la finalidad de comunicarles que el/los compañeros,<span style="font-size: 1.2em; font-weight: bold;"> ${nombreApellido}</span> no asistió/ieron a su labor habitual durante el/los días<span style="font-size: 1.2em; font-weight: bold;"> ${fechaPermiso}</span>, por haber estado afectado/a a tareas gremiales en esta asociación sindical.</p>
                        <p style="line-height: 2;">Con tal motivo, requerimos de su amabilidad quiera tener a bien reconocer los jornales correspondientes conjuntamente con los adicionales que se aplican según lo estipulado en el CCT 40/89.</p>
                        <p>Sin otro particular, saludamos a UD. Muy atentamente.</p>
                    </div>
                </body>
                </html>
            `;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();

            // Change button text and color after printing
            button.textContent = 'Ya se imprimió';
            button.classList.add('printed');
            button.disabled = true;
        }

        window.onload = fetchData;
    </script>
</head>
<body>
    <h1>Datos de permisos Gremiales</h1>
    <table id="data-table">
        <thead>
            <tr>
                <th>Nombre y Apellido</th>
                <th>Fecha de Permiso</th>
                <th>Empresa</th>
                <th>Solicitado</th>
            </tr>
        </thead>
        <tbody id="table-body">
            <!-- Data rows will be inserted here dynamically -->
        </tbody>
    </table>
</body>
</html>
